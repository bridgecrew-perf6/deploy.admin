(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[88],{NkBc:function(e,a,t){e.exports={header:"antd-pro-pages-info-index-header",search:"antd-pro-pages-info-index-search",cols:"antd-pro-pages-info-index-cols",content:"antd-pro-pages-info-index-content",btns:"antd-pro-pages-info-index-btns",modelMsg:"antd-pro-pages-info-index-modelMsg",check:"antd-pro-pages-info-index-check",arrow:"antd-pro-pages-info-index-arrow",table:"antd-pro-pages-info-index-table"}},cWLO:function(e,a,t){"use strict";t.r(a);t("bbsP");var l,n,r,o,i,s,c,d,u,p,m,y,h,E,f,v,g,w,k,b,S,x,D,V,C=t("/wGt"),O=t("jehZ"),I=t.n(O),A=(t("IzEo"),t("bx4M")),q=(t("g9YV"),t("wCAj")),_=(t("5NDa"),t("5rEg")),T=(t("miYZ"),t("tsqr")),L=(t("2qtc"),t("kLXV")),R=(t("lUTK"),t("BvKs")),F=(t("qVdP"),t("jsC+")),P=(t("+L6B"),t("2/Rp")),B=(t("Pwec"),t("CtXQ")),N=(t("/zsF"),t("PArb")),j=t("2Taf"),z=t.n(j),M=t("vZ4D"),U=t.n(M),H=t("l4Ni"),G=t.n(H),K=t("ujKo"),Z=t.n(K),J=t("MhPg"),X=t.n(J),W=(t("y8nQ"),t("Vl3Y")),Y=t("q1tI"),Q=t.n(Y),$=t("MuoO"),ee=t("NkBc"),ae=t.n(ee),te=t("zHco"),le=(t("14J3"),t("BMrR")),ne=(t("OaEy"),t("2fM7")),re=(t("jCWc"),t("kPKH")),oe=t("P4xi"),ie=(l=Object($["connect"])(function(e){var a=e.approval,t=e.loading;return{approval:a,loading:t.models.approval}}),n=W["a"].create(),l(r=n((o=function(e){function a(){var e,t;z()(this,a);for(var l=arguments.length,n=new Array(l),r=0;r<l;r++)n[r]=arguments[r];return t=G()(this,(e=Z()(a)).call.apply(e,[this].concat(n))),t.state={drawerData:[],sxbs:""},t.add=function(){t.props.form;var e=t.state.drawerData,a={key:"",name:"",type:"",values:""};e.push(a),t.setState({drawerData:e})},t.remove=function(e){t.props.form;var a=t.state.drawerData;a.splice(e,1),t.setState({drawerData:a})},t.sxSubmit=function(e){e&&e.preventDefault();var a=t.props,l=a.modelData,n=a.dispatch;t.props.form.validateFields(function(e,a){console.log("values of form: ",a.name);var r=a.key;console.log("====listkey===",r);var o=a.name,i=a.type,s=a.values,c=[],d=1;if("undefined"==r||void 0==r)c=[];else for(var u=0;u<r.length;u++){var p=o[u],m=i[u];if(""==p||"null"==p)return void T["a"].error("\u5c5e\u6027\u7684\u540d\u5b57\u4e0d\u80fd\u4e3a\u7a7a");if(""==m||"null"==m)return void T["a"].error("\u5c5e\u6027\u7684\u7c7b\u578b\u4e0d\u80fd\u4e3a\u7a7a");var y={};y.key=(d+u).toString(),y.name=o[u],y.type=i[u],y.values=s[u],c.push(y)}console.log("====props===",c);JSON.stringify(c);n({type:"approval/setTarget",payload:{id:l._id,name:l.name,desc:l.desc,timeout:l.timeout,props:c,event:null},callback:function(e){0==e.code?oe["a"].successAddOrEidt("\u65b0\u589e\u5ba1\u6279\u5bf9\u8c61\u5c5e\u6027\u6210\u529f\uff01",function(){t.props.query(),t.forceUpdate(),t.props.drawerClose()}):oe["a"].error(null,"\u9519\u8bef",Q.a.createElement("div",null,Q.a.createElement("span",null,T["a"])),function(){})}})})},t}return X()(a,e),U()(a,[{key:"componentDidMount",value:function(){var e=this.props.drawerData;console.log(e),this.setState({drawerData:e})}},{key:"render",value:function(){var e=this,a=this.props.form,t=this.state.drawerData,l=a.getFieldDecorator,n={wrapperCol:{xs:{span:24,offset:0},sm:{span:20,offset:4}}},r={labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}},o=t.map(function(a,t){return Q.a.createElement("div",{key:t},Q.a.createElement(le["a"],{span:24},Q.a.createElement(re["a"],{span:6},Q.a.createElement(W["a"].Item,I()({},r,{label:"\u5c5e\u6027\u7684\u540d\u5b57"}),l("name[".concat(t,"]"),{initialValue:a.name,rules:[{required:!0,message:"\u5c5e\u6027\u7684\u540d\u5b57\u4e0d\u80fd\u4e3a\u7a7a"}]})(Q.a.createElement(_["a"],{placeholder:"",style:{width:"80%"}})))),Q.a.createElement(re["a"],{span:6},Q.a.createElement(W["a"].Item,I()({},r,{label:"\u5c5e\u6027\u7684\u7c7b\u578b"}),l("type[".concat(t,"]"),{initialValue:a.type,rules:[{required:!0,message:"\u5c5e\u6027\u7684\u7c7b\u578b\u4e0d\u80fd\u4e3a\u7a7a"}]})(Q.a.createElement(ne["a"],{allowClear:!0,showSearch:!0,placeholder:"\u8bf7\u9009\u62e9\u5c5e\u6027\u7684\u7c7b\u578b",style:{width:"80%"}},Q.a.createElement(ne["a"].Option,{key:"0",value:"0"},"Boolean"),Q.a.createElement(ne["a"].Option,{key:"1",value:"1"},"String"),Q.a.createElement(ne["a"].Option,{key:"2",value:"2"},"Number"))))),Q.a.createElement(re["a"],{span:6},Q.a.createElement(W["a"].Item,I()({},r,{label:"\u5c5e\u6027\u7684\u53ef\u9009\u503c"}),l("values[".concat(t,"]"),{initialValue:a.values})(Q.a.createElement(_["a"],{placeholder:"",style:{width:"80%",marginLeft:5}})))),Q.a.createElement(re["a"],{span:5},Q.a.createElement(W["a"].Item,I()({},r,{label:"\u5c5e\u6027\u7684\u6807\u8bc6",style:{display:"none"}}),l("key[".concat(t,"]"),{initialValue:a.key})(Q.a.createElement(_["a"],{placeholder:"",style:{width:"80%",marginLeft:5}})))),Q.a.createElement(re["a"],{span:1},Q.a.createElement(B["a"],{type:"minus-circle-o",onClick:function(){return e.remove(t)}}))))});return Q.a.createElement("div",null,Q.a.createElement(W["a"],null,o,Q.a.createElement(W["a"].Item,n,Q.a.createElement(P["a"],{type:"dashed",onClick:this.add,style:{width:"60%"}},Q.a.createElement(B["a"],{type:"plus"})," \u5ba1\u6279\u5bf9\u8c61\u5c5e\u6027\u7684\u5b9a\u4e49")),Q.a.createElement(W["a"].Item,null,Q.a.createElement(P["a"],{type:"primary",onClick:this.sxSubmit},"\u786e\u8ba4"))))}}]),a}(Y["Component"]),r=o))||r)||r),se=t("eHn4"),ce=t.n(se),de=(t("5Dmo"),t("3S7+")),ue=(t("+BJd"),t("mr32")),pe=(t("BoS7"),t("Sdc0")),me=(W["a"].Item,i=Object($["connect"])(function(e){var a=e.approval,t=e.loading;return{approval:a,loading:t.models.approval}}),s=W["a"].create(),i(c=s((d=function(e){function a(){var e,t;z()(this,a);for(var l=arguments.length,n=new Array(l),r=0;r<l;r++)n[r]=arguments[r];return t=G()(this,(e=Z()(a)).call.apply(e,[this].concat(n))),t.state={data:[],sxdyVisible:!1,drawerData:[],userlist:[],Rolelist:[]},t.sxSubmit=function(e){e&&e.preventDefault();var a=t.props,l=a.dispatch,n=a.modelData,r=a.Addrecord;t.props.form.validateFieldsAndScroll(function(e,a){if(console.log("=====values==",a),console.log("=====modelData==",n),console.log("=====Addrecord==",r),void 0!=a.user||void 0!=a.role){for(var o=a.type,i=a.props,s=a.Stringkey,c=a.StringValue,d=a.amount1key,u=a.amount2key,p=a.amount1Value,m=a.amount2Value,y=a.gxysf,h=[],E=[],f=0;f<o.length;f++){var v={},g=o[f];if("1"==g)if(""==c||"null"==c||void 0==c||"undefined"==c);else{console.log("====StringValue==",c),E=Array.of(c),console.log("====Stringlist==",E);var w=ce()({},s,E);v=ce()({},i[f],w),h.push(v)}else if("2"==g)if(""!=p&&"null"!=p&&void 0!=p&&"undefined"!=p||""!=m&&"null"!=m&&void 0!=m&&"undefined"!=m){var k={};void 0==d||"undefined"==d||""==d||(k[d]=1*p),void 0==u||"undefined"==u||""==u||(k[u]=1*m),v=ce()({},i[f],k),h.push(v)}else;}var b=ce()({},y,h);console.log("=====rules==",b),l({type:"approval/addRule",payload:{name:a.name,desc:a.desc,parent:r._id,target:n._id,rules:b,roles:a.role,users:a.user,helper:null},callback:function(e){console.log("===data==",e);var a=e.code,l=(e.datas,e.message);0==a?oe["a"].successAddOrEidt("\u65b0\u589e\u5b50\u89c4\u5219\u6210\u529f\uff01",function(){t.props.query(),t.forceUpdate(),t.props.AdddrawerClose()}):oe["a"].error(null,"\u9519\u8bef",Q.a.createElement("div",null,Q.a.createElement("span",null,l)),function(){}),t.handleHideLoading()}})}else message.error("\u5ba1\u6279\u7528\u6237\u548c\u5ba1\u6279\u89d2\u8272\u6700\u5c11\u9009\u62e9\u4e00\u9879\uff01")})},t.handleHideLoading=function(){t.setState({loading:!1})},t}return X()(a,e),U()(a,[{key:"componentDidMount",value:function(){this.query(),this.listUserS(),this.getRoleTree()}},{key:"listUserS",value:function(){var e=this,a=this.props,t=a.dispatch;a.modelData;t({type:"approval/listUserS",payload:{name:null,types:null,tags:null,roles:null,domain:"system",props:null,sortBy:["name",1],skip:0,limit:0},callback:function(a){0==a.code&&(console.log(a.data),e.setState({userlist:a.data[1],loading:!1}))}})}},{key:"query",value:function(){var e=this,a=this.props,t=a.dispatch,l=a.modelData;t({type:"approval/listRule",payload:{name:null,target:l._id,parent:null,status:null,sortby:list,skip:0,limit:0},callback:function(a){0==a.code&&(console.log(a.data),e.setState({data:a.data,loading:!1}))}})}},{key:"getRoleTree",value:function(){var e=this,a=this.props,t=a.dispatch;a.modelData;t({type:"approval/getRoleTree",payload:{tags:null,depth:0,name:null,domain:"system"},callback:function(a){0==a.code&&(console.log(a.data),e.setState({Rolelist:a.data,loading:!1}))}})}},{key:"render",value:function(){var e=this.state,a=(e.loading,e.data,e.spdxVisible,e.drawerData,this.props.form),t=a.getFieldDecorator,l=(a.getFieldValue,this.props),n=l.modelData,r=l.Addrecord;console.log("====Addrecord===",r),console.log("====modelData===",n);var o=n.props,i={labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}},s=t("Stringkey")(Q.a.createElement(ne["a"],{style:{width:"100px"}},Q.a.createElement(Option,{value:"#in"},"\u5305\u542b"),Q.a.createElement(Option,{value:"#nin"},"\u53cd\u5411\u5305\u542b"))),c=t("amount1key")(Q.a.createElement(ne["a"],{style:{width:"100px"}},Q.a.createElement(Option,{key:"#lt",value:"#lt"},"\u5c0f\u4e8e"),Q.a.createElement(Option,{value:"#lte"},"\u5c0f\u4e8e\u7b49\u4e8e"),Q.a.createElement(Option,{value:"#gt"},"\u5927\u4e8e"),Q.a.createElement(Option,{value:"#gte"},"\u5927\u4e8e\u7b49\u4e8e"),Q.a.createElement(Option,{value:"#eq"},"\u7b49\u4e8e"),Q.a.createElement(Option,{value:"#ne"},"\u4e0d\u7b49\u4e8e"))),d=t("amount2key")(Q.a.createElement(ne["a"],{style:{width:"100px"}},Q.a.createElement(Option,{value:"#lt"},"\u5c0f\u4e8e"),Q.a.createElement(Option,{value:"#lte"},"\u5c0f\u4e8e\u7b49\u4e8e"),Q.a.createElement(Option,{value:"#gt"},"\u5927\u4e8e"),Q.a.createElement(Option,{value:"#gte"},"\u5927\u4e8e\u7b49\u4e8e"),Q.a.createElement(Option,{value:"#eq"},"\u7b49\u4e8e"),Q.a.createElement(Option,{value:"#ne"},"\u4e0d\u7b49\u4e8e"))),u=o.map(function(e,a){return Q.a.createElement("div",{key:a},Q.a.createElement(le["a"],{span:24},Q.a.createElement(re["a"],{span:5},Q.a.createElement(W["a"].Item,I()({},i,{label:"\u5bf9\u8c61\u5c5e\u6027"}),t("props[".concat(a,"]"),{initialValue:e.name})(Q.a.createElement(_["a"],{disabled:!0})))),Q.a.createElement(re["a"],{span:5},"1"==e.type?Q.a.createElement(W["a"].Item,I()({},i,{label:"\u6761\u4ef6\u8fd0\u7b97\u7b26"}),t("StringValue",{})(Q.a.createElement(_["a"],{addonBefore:s}))):"2"==e.type?Q.a.createElement(Q.a.Fragment,null,Q.a.createElement(W["a"].Item,I()({},i,{label:"\u6761\u4ef6\u8fd0\u7b97\u7b26"}),t("amount1Value",{})(Q.a.createElement(_["a"],{addonBefore:c}))),Q.a.createElement(W["a"].Item,I()({},i,{label:"         ",style:{marginTop:"-30px"}}),t("amount2Value",{})(Q.a.createElement(_["a"],{addonBefore:d})))):"0"==e.type?Q.a.createElement("div",null,"kgjdfgg"):null),Q.a.createElement(re["a"],{span:5},Q.a.createElement(W["a"].Item,I()({},i,{label:"\u5bf9\u8c61\u7c7b\u578b",style:{display:"none"}}),t("type[".concat(a,"]"),{initialValue:e.type})(Q.a.createElement(_["a"],{disabled:!0}))))))});return Q.a.createElement("div",null,Q.a.createElement(le["a"],{span:24},Q.a.createElement(re["a"],{span:5},Q.a.createElement(W["a"].Item,I()({},i,{label:"\u89c4\u5219\u540d\u79f0"}),t("name",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u89c4\u5219\u540d\u79f0!"}]})(Q.a.createElement(_["a"],{placeholder:"",style:{width:"80%"}})))),Q.a.createElement(re["a"],{span:5},Q.a.createElement(W["a"].Item,I()({},i,{label:"\u89c4\u5219\u8bf4\u660e"}),t("desc",{})(Q.a.createElement(_["a"],{placeholder:"",style:{width:"80%"}}))))),Q.a.createElement(le["a"],null,Q.a.createElement(re["a"],{span:5},Q.a.createElement(W["a"].Item,I()({},i,{label:"\u5ba1\u6279\u7528\u6237"}),t("user")(Q.a.createElement(ne["a"],{mode:"tags",allowClear:!0,showSearch:!0,placeholder:"\u8bf7\u9009\u62e9\u5ba1\u6279\u7528\u6237",style:{width:"80%"}},this.state.userlist?this.state.userlist.map(function(e){return Q.a.createElement(ne["a"].Option,{key:e.account,value:e.account},e.account)}):null)))),Q.a.createElement(re["a"],{span:5},Q.a.createElement(W["a"].Item,I()({},i,{label:"\u5ba1\u6279\u89d2\u8272"}),t("role",{initialValue:""})(Q.a.createElement(ne["a"],{allowClear:!0,showSearch:!0,placeholder:"\u8bf7\u9009\u62e9\u5ba1\u6279\u89d2\u8272",style:{width:"80%"}},this.state.Rolelist?this.state.Rolelist.map(function(e){return Q.a.createElement(ne["a"].Option,{key:e.name,value:e.name},e.name)}):null))))),Q.a.createElement(le["a"],null,Q.a.createElement(re["a"],{span:5},Q.a.createElement(W["a"].Item,I()({},i,{label:"\u5173\u7cfb\u8fd0\u7b97\u7b26"}),t("gxysf",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u5173\u7cfb\u8fd0\u7b97\u7b26!"}]})(Q.a.createElement(ne["a"],{allowClear:!0,showSearch:!0,placeholder:"\u8bf7\u9009\u62e9\u5ba1\u6279\u4eba\u89d2\u8272",style:{width:"80%"}},Q.a.createElement(ne["a"].Option,{key:"#and",value:"#and"},"\u5e76\u4e14"),Q.a.createElement(ne["a"].Option,{key:"#or",value:"#or"},"\u6216\u8005"),Q.a.createElement(ne["a"].Option,{key:"#not",value:"#not"},"\u975e")))))),u,Q.a.createElement(W["a"].Item,null,Q.a.createElement(P["a"],{type:"primary",onClick:this.sxSubmit},"\u786e\u8ba4")))}}]),a}(Y["Component"]),c=d))||c)||c),ye=(W["a"].Item,u=Object($["connect"])(function(e){var a=e.approval,t=e.loading;return{approval:a,loading:t.models.approval}}),p=W["a"].create(),u(m=p((y=function(e){function a(){var e,t;z()(this,a);for(var l=arguments.length,n=new Array(l),r=0;r<l;r++)n[r]=arguments[r];return t=G()(this,(e=Z()(a)).call.apply(e,[this].concat(n))),t.state={data:[],sxdyVisible:!1,drawerData:[],userlist:[],Rolelist:[]},t.sxSubmit=function(e){e&&e.preventDefault();var a=t.props,l=a.dispatch,n=a.modelData,r=a.Editrecord;t.props.form.validateFieldsAndScroll(function(e,a){if(console.log("=====values==",a),console.log("=====modelData==",n),console.log("=====Editrecord==",r),void 0!=a.user||void 0!=a.role){for(var o=a.type,i=a.props,s=a.Stringkey,c=a.StringValue,d=a.amount1key,u=a.amount2key,p=a.amount1Value,m=a.amount2Value,y=a.gxysf,h=[],E=[],f=0;f<o.length;f++){var v={},g=o[f];if("1"==g)if(""==c||"null"==c||void 0==c||"undefined"==c);else{console.log("====StringValue==",c),E=Array.of(c),console.log("====Stringlist==",E);var w=ce()({},s,E);v=ce()({},i[f],w),h.push(v)}else if("2"==g)if(""!=p&&"null"!=p&&void 0!=p&&"undefined"!=p||""!=m&&"null"!=m&&void 0!=m&&"undefined"!=m){var k={};void 0==d||"undefined"==d||""==d||(k[d]=1*p),void 0==u||"undefined"==u||""==u||(k[u]=1*m),v=ce()({},i[f],k),h.push(v)}else;}var b=ce()({},y,h);console.log("=====values==",a.role),l({type:"approval/setRule",payload:{id:r._id,name:a.name,desc:a.desc,status:r.status,rules:b,roles:void 0==a.role?null:a.role,users:a.user,helper:null},callback:function(e){console.log("===data==",e);var a=e.code,l=(e.datas,e.message);0==a?oe["a"].successAddOrEidt("\u4fee\u6539\u89c4\u5219\u6210\u529f\uff01",function(){t.props.query(),t.forceUpdate(),t.props.EditdrawerClose()}):oe["a"].error(null,"\u9519\u8bef",Q.a.createElement("div",null,Q.a.createElement("span",null,l)),function(){}),t.handleHideLoading()}})}else message.error("\u5ba1\u6279\u7528\u6237\u548c\u5ba1\u6279\u89d2\u8272\u6700\u5c11\u9009\u62e9\u4e00\u9879\uff01")})},t.handleHideLoading=function(){t.setState({loading:!1})},t}return X()(a,e),U()(a,[{key:"componentDidMount",value:function(){this.query(),this.listUserS(),this.getRoleTree()}},{key:"listUserS",value:function(){var e=this,a=this.props,t=a.dispatch;a.modelData;t({type:"approval/listUserS",payload:{name:null,types:null,tags:null,roles:null,domain:"system",props:null,sortBy:["name",1],skip:0,limit:0},callback:function(a){0==a.code&&(console.log(a.data),e.setState({userlist:a.data[1],loading:!1}))}})}},{key:"query",value:function(){var e=this,a=this.props,t=a.dispatch,l=a.modelData;t({type:"approval/listRule",payload:{name:null,target:l._id,parent:null,status:null,sortby:list,skip:0,limit:0},callback:function(a){0==a.code&&(console.log(a.data),e.setState({data:a.data,loading:!1}))}})}},{key:"getRoleTree",value:function(){var e=this,a=this.props,t=a.dispatch;a.modelData;t({type:"approval/getRoleTree",payload:{tags:null,depth:0,name:null,domain:"system"},callback:function(a){0==a.code&&(console.log(a.data),e.setState({Rolelist:a.data,loading:!1}))}})}},{key:"render",value:function(){var e=this.state,a=(e.loading,e.data,e.spdxVisible,e.drawerData,this.props.form),t=a.getFieldDecorator,l=(a.getFieldValue,this.props),n=l.modelData,r=l.Editrecord;console.log("====modelData===",n),console.log("====EditrecordEditrecord===",r);var o=n.props,i={labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}},s=t("Stringkey",{initialValue:r.StringKeys})(Q.a.createElement(ne["a"],{allowClear:!0,style:{width:"100px"}},Q.a.createElement(Option,{value:"#in"},"\u5305\u542b"),Q.a.createElement(Option,{value:"#nin"},"\u53cd\u5411\u5305\u542b"))),c=t("amount1key",{initialValue:r.amount1keys})(Q.a.createElement(ne["a"],{allowClear:!0,style:{width:"100px"}},Q.a.createElement(Option,{key:"#lt",value:"#lt"},"\u5c0f\u4e8e"),Q.a.createElement(Option,{value:"#lte"},"\u5c0f\u4e8e\u7b49\u4e8e"),Q.a.createElement(Option,{value:"#gt"},"\u5927\u4e8e"),Q.a.createElement(Option,{value:"#gte"},"\u5927\u4e8e\u7b49\u4e8e"),Q.a.createElement(Option,{value:"#eq"},"\u7b49\u4e8e"),Q.a.createElement(Option,{value:"#ne"},"\u4e0d\u7b49\u4e8e"))),d=t("amount2key",{initialValue:r.amount2keys})(Q.a.createElement(ne["a"],{allowClear:!0,style:{width:"100px"}},Q.a.createElement(Option,{value:"#lt"},"\u5c0f\u4e8e"),Q.a.createElement(Option,{value:"#lte"},"\u5c0f\u4e8e\u7b49\u4e8e"),Q.a.createElement(Option,{value:"#gt"},"\u5927\u4e8e"),Q.a.createElement(Option,{value:"#gte"},"\u5927\u4e8e\u7b49\u4e8e"),Q.a.createElement(Option,{value:"#eq"},"\u7b49\u4e8e"),Q.a.createElement(Option,{value:"#ne"},"\u4e0d\u7b49\u4e8e")));return console.log("====target===",o),Q.a.createElement("div",null,Q.a.createElement(le["a"],{span:24},Q.a.createElement(re["a"],{span:8},Q.a.createElement(W["a"].Item,I()({},i,{label:"\u89c4\u5219\u540d\u79f0"}),t("name",{initialValue:r.names,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u89c4\u5219\u540d\u79f0!"}]})(Q.a.createElement(_["a"],{allowClear:!0,placeholder:"",style:{width:"80%"}})))),Q.a.createElement(re["a"],{span:8},Q.a.createElement(W["a"].Item,I()({},i,{label:"\u89c4\u5219\u8bf4\u660e"}),t("desc",{initialValue:r.descs})(Q.a.createElement(_["a"],{allowClear:!0,placeholder:"",style:{width:"80%"}}))))),Q.a.createElement(le["a"],{span:24},Q.a.createElement(re["a"],{span:8},Q.a.createElement(W["a"].Item,I()({},i,{label:"\u5ba1\u6279\u7528\u6237"}),t("user",{initialValue:r.users})(Q.a.createElement(ne["a"],{mode:"tags",allowClear:!0,showSearch:!0,placeholder:"\u8bf7\u9009\u62e9\u5ba1\u6279\u7528\u6237",style:{width:"80%"}},this.state.userlist?this.state.userlist.map(function(e){return Q.a.createElement(ne["a"].Option,{key:e.account,value:e.account},e.account)}):null))))),Q.a.createElement(le["a"],{span:24},Q.a.createElement(re["a"],{span:8},Q.a.createElement(W["a"].Item,I()({},i,{label:"\u5173\u7cfb\u8fd0\u7b97\u7b26"}),t("gxysf",{initialValue:r.gxysfs,rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u5173\u7cfb\u8fd0\u7b97\u7b26!"}]})(Q.a.createElement(ne["a"],{allowClear:!0,showSearch:!0,placeholder:"\u8bf7\u9009\u62e9\u5173\u7cfb\u8fd0\u7b97\u7b26",style:{width:"80%"}},Q.a.createElement(ne["a"].Option,{key:"#and",value:"#and"},"\u5e76\u4e14"),Q.a.createElement(ne["a"].Option,{key:"#or",value:"#or"},"\u6216\u8005"),Q.a.createElement(ne["a"].Option,{key:"#not",value:"#not"},"\u975e")))))),o.map(function(e,a){return Q.a.createElement("div",{key:a},Q.a.createElement(le["a"],{span:24},Q.a.createElement(re["a"],{span:8},Q.a.createElement(W["a"].Item,I()({},i,{label:"\u5bf9\u8c61\u5c5e\u6027"}),t("props[".concat(a,"]"),{initialValue:e.name})(Q.a.createElement(_["a"],{disabled:!0})))),Q.a.createElement(re["a"],{span:8},"1"==e.type?Q.a.createElement(W["a"].Item,I()({},i,{label:"\u6761\u4ef6\u8fd0\u7b97\u7b26"}),t("StringValue",{initialValue:r.StringValues})(Q.a.createElement(_["a"],{allowClear:!0,addonBefore:s}))):"2"==e.type?Q.a.createElement(Q.a.Fragment,null,Q.a.createElement(W["a"].Item,I()({},i,{label:"\u6761\u4ef6\u8fd0\u7b97\u7b26"}),t("amount1Value",{initialValue:r.amount1values})(Q.a.createElement(_["a"],{allowClear:!0,addonBefore:c}))),Q.a.createElement(W["a"].Item,I()({},i,{label:"         ",style:{marginTop:"-30px"}}),t("amount2Value",{initialValue:r.amount2values})(Q.a.createElement(_["a"],{allowClear:!0,addonBefore:d})))):"0"==e.type?Q.a.createElement("div",null,"kgjdfgg"):null),Q.a.createElement(re["a"],{span:8},Q.a.createElement(W["a"].Item,I()({},i,{label:"\u5bf9\u8c61\u7c7b\u578b",style:{display:"none"}}),t("type[".concat(a,"]"),{initialValue:e.type})(Q.a.createElement(_["a"],{disabled:!0}))))))}),Q.a.createElement(W["a"].Item,null,Q.a.createElement(P["a"],{type:"primary",onClick:this.sxSubmit},"\u786e\u8ba4")))}}]),a}(Y["Component"]),m=y))||m)||m),he=t("6Hmz"),Ee=(W["a"].Item,he["a"].SPGL_SPGZ_ADD.key),fe=he["a"].SPGL_SPGZ_DETAIL.key,ve=he["a"].SPGL_SPGZ_DELATE.key,ge=he["a"].SPGL_SPGZ_ADDZI.key,we=(h=Object($["connect"])(function(e){var a=e.approval,t=e.loading;return{approval:a,loading:t.models.approval}}),E=W["a"].create(),h(f=E((v=function(e){function a(){var e,t;z()(this,a);for(var l=arguments.length,n=new Array(l),r=0;r<l;r++)n[r]=arguments[r];return t=G()(this,(e=Z()(a)).call.apply(e,[this].concat(n))),t.state={columns:[{title:"\u89c4\u5219\u540d\u5b57",dataIndex:"name",width:"20%"},{title:"\u89c4\u5219\u8bf4\u660e",dataIndex:"desc",width:"20%"},{title:"\u72b6\u6001",dataIndex:"status",width:"15%",render:function(e,a){var l=!1;return l=0===e,console.log("=====record===",a),Q.a.createElement(pe["a"],{checkedChildren:"\u5f00",unCheckedChildren:"\u5173",defaultChecked:l,onClick:function(){return t.SwitchOnSlect(a)}})}},{title:"\u5ba1\u6279\u4eba\u7684\u7528\u6237",dataIndex:"users",width:"30%",render:function(e){if(e)return Q.a.createElement("span",null,e.map(function(e){return Q.a.createElement(ue["a"],{color:"blue",key:e},e)}))}},{title:"\u64cd\u4f5c",align:"center",key:"action",width:"15%",render:function(e){return Q.a.createElement("span",null,Q.a.createElement("a",{onClick:function(a){a&&a.preventDefault(),oe["a"].checkAuthAndExecute(t.props.dispatch,fe,function(){return t.EditShowDrawer(e)},[])}},"\u8be6\u60c5"),Q.a.createElement(N["a"],{type:"vertical"}),Q.a.createElement(F["a"],{overlay:t.CzMenu(e)},Q.a.createElement(P["a"],{size:"small"},"\u66f4\u591a ",Q.a.createElement(B["a"],{type:"down"}))))}}],data:[],sxdyVisible:!1,AddsxdyVisible:!1,drawerData:[],userlist:[],Addrecord:[],Rolelist:[],EditsxdyVisible:!1,Editrecord:{}},t.SwitchOnSlect=function(e){console.log("====record====",e);var a=t.props.dispatch,l=null;l=0===e.status?-1:0,console.log("====statue===",l),a({type:"approval/setRuleStatus",payload:{id:e._id,status:l},callback:function(e){console.log("===resp===",e),0==e.code?oe["a"].successAddOrEidt("\u4fee\u6539\u5ba1\u6279\u89c4\u5219\u72b6\u6001\u6210\u529f\uff01",function(){t.query()}):oe["a"].error(null,"\u9519\u8bef",Q.a.createElement("div",null,Q.a.createElement("span",null,message)),function(){})}})},t.CzMenu=function(e){return Q.a.createElement(R["a"],null,Q.a.createElement(R["a"].Item,null,Q.a.createElement(P["a"],{type:"link",size:"small",onClick:function(a){a&&a.preventDefault(),oe["a"].checkAuthAndExecute(t.props.dispatch,ge,function(){return t.AddShowDrawer(e)},[],t.handleHideLoading)}},"\u589e\u52a0\u5b50\u89c4\u5219")),0===e.children.length?Q.a.createElement(R["a"].Item,null,Q.a.createElement(P["a"],{type:"link",size:"small",onClick:function(a){a&&a.preventDefault(),oe["a"].checkAuthAndExecute(t.props.dispatch,ve,function(){return t.delRule(e)},[],t.handleHideLoading)}},"\u5220\u9664")):Q.a.createElement(R["a"].Item,null,Q.a.createElement(de["a"],{title:"\u8be5\u89c4\u5219\u5305\u542b\u5b50\u89c4\u5219\u4e0d\u53ef\u4ee5\u5220\u9664\uff01"},Q.a.createElement(P["a"],{type:"link",size:"small",disabled:!0},"\u5220\u9664"))))},t.delRule=function(e){var a=t.props.dispatch;L["a"].confirm({title:"\u786e\u8ba4\u5220\u9664 '".concat(e.name?e.name:"\u8be5\u89c4\u5219","' \u5417?"),content:"",okText:"\u662f",okType:"danger",cancelText:"\u5426",onOk:function(){a({type:"approval/delRule",payload:{id:e._id},callback:function(e){console.log("==data===",e);var a=e.code,l=(e.datas,e.message);0==a?oe["a"].successAddOrEidt("\u5220\u9664\u5ba1\u6279\u89c4\u5219\u6210\u529f\uff01",function(){t.setState({sxdyVisible:"false"}),t.drawerClose(),t.query()}):oe["a"].error(null,"\u9519\u8bef",Q.a.createElement("div",null,Q.a.createElement("span",null,l)),function(){t.setState({sxdyVisible:"false"})})}})}})},t.ShowDrawer=function(){t.setState({sxdyVisible:!0})},t.drawerClose=function(){t.setState({sxdyVisible:!1})},t.AdddrawerClose=function(){t.setState({AddsxdyVisible:!1,Addrecord:[]})},t.AddShowDrawer=function(e){t.setState({AddsxdyVisible:!0,Addrecord:e})},t.EditdrawerClose=function(){console.log("===hddfdff==="),t.setState({EditsxdyVisible:!1,Editrecord:{},sxdyVisible:!1})},t.EditShowDrawer=function(e){var a=e.rules;console.log("====rules===",a);var l="",n=[];Object.keys(a).map(function(e,t){l=e,n=a[e]});var r="",o="",i="",s="",c="",d="";console.log("=====value====",n),n.forEach(function(e,a){console.log("====element===",e),console.log("=====k===",a),Object.keys(e).map(function(a,t){if(console.log("=====key====",a),"FaceAmount"==a||"Notional"==a||"NotionalAmount"==a){var l=e[a];console.log("====va===",l),Object.keys(l).map(function(e,a){console.log("====keyVa===",e),console.log("====indexVa===",a),0===a?(r=e,i=l[e]):1===a&&(o=e,s=l[e])})}else if("Cpty"==a||"cpty"==a){var n=e[a];console.log("====vaString===",n),Object.keys(n).map(function(e,a){c=e,d=n[e]})}})}),console.log("====StringKey===",c),console.log("====StringValue===",d),console.log("=====amount1key====",r),console.log("=====amount2key====",o),console.log("=====amount1value====",i),console.log("=====amount2value====",s);var u={};u.amount1keys=r,u.amount2keys=o,u.amount1values=i,u.amount2values=s,u.names=e.name,u.descs=e.desc,u.gxysfs=l,u.users=e.users,u.roles=e.roles,u._id=e._id,u.status=e.status,u.StringKeys=c,u.StringValues=d,console.log("====map==",u),t.setState({EditsxdyVisible:!0,Editrecord:u})},t.add=function(){t.props.form;var e=t.state.drawerData,a={key:"",name:"",type:"",values:"",isCpty:!1};e.push(a),t.setState({drawerData:e})},t.remove=function(e){t.props.form;var a=t.state.drawerData;a.splice(e,1),t.setState({drawerData:a})},t.sxSubmit=function(e){e&&e.preventDefault();var a=t.props,l=a.dispatch,n=a.modelData;t.props.form.validateFieldsAndScroll(function(e,a){if(console.log("=====values==",a),console.log("=====modelData==",n),void 0!=a.user||void 0!=a.role){for(var r=a.type,o=a.props,i=a.Stringkey,s=a.StringValue,c=a.amount1key,d=a.amount2key,u=a.amount1Value,p=a.amount2Value,m=a.gxysf,y=[],h=[],E=0;E<r.length;E++){var f={},v=r[E];if("1"==v)if(""==s||"null"==s||void 0==s||"undefined"==s);else{console.log("====StringValue==",s),h=Array.of(s),console.log("====Stringlist==",h);var g=ce()({},i,h);f=ce()({},o[E],g),y.push(f)}else if("2"==v)if(""!=u&&"null"!=u&&void 0!=u&&"undefined"!=u||""!=p&&"null"!=p&&void 0!=p&&"undefined"!=p){var w={};void 0==c||"undefined"==c||(w[c]=1*u),void 0==d||"undefined"==d||(w[d]=1*p),f=ce()({},o[E],w),y.push(f)}else;}var k=ce()({},m,y);console.log("=====rules==",k),l({type:"approval/addRule",payload:{name:a.name,desc:a.desc,target:n._id,parent:null,rules:k,roles:a.role,users:a.user,helper:null},callback:function(e){console.log("===data==",e);var a=e.code,l=(e.datas,e.message);0==a?oe["a"].successAddOrEidt("\u65b0\u589e\u89c4\u5219\u6210\u529f\uff01",function(){t.setState({sxdyVisible:"false"}),t.drawerClose(),t.query()}):oe["a"].error(null,"\u9519\u8bef",Q.a.createElement("div",null,Q.a.createElement("span",null,l)),function(){t.setState({sxdyVisible:"false"})}),t.handleHideLoading()}})}else message.error("\u5ba1\u6279\u7528\u6237\u548c\u5ba1\u6279\u89d2\u8272\u6700\u5c11\u9009\u62e9\u4e00\u9879\uff01")})},t.handleHideLoading=function(){t.setState({loading:!1})},t}return X()(a,e),U()(a,[{key:"componentDidMount",value:function(){this.query(),this.listUserS(),this.getRoleTree()}},{key:"listUserS",value:function(){var e=this,a=this.props,t=a.dispatch;a.modelData;t({type:"approval/listUserS",payload:{name:null,types:null,tags:null,roles:null,domain:"system",props:null,sortBy:["name",1],skip:0,limit:0},callback:function(a){0==a.code&&(console.log(a.data),e.setState({userlist:a.data[1],loading:!1}))}})}},{key:"getRoleTree",value:function(){var e=this,a=this.props,t=a.dispatch;a.modelData;t({type:"approval/getRoleTree",payload:{tags:null,depth:0,name:null,domain:"system"},callback:function(a){0==a.code&&e.setState({Rolelist:a.data,loading:!1})}})}},{key:"query",value:function(){var e=this,a=this.props,t=a.dispatch,l=a.modelData,n=["name",1];t({type:"approval/listRule",payload:{name:null,target:l._id,parent:null,status:null,sortby:n,skip:0,limit:0},callback:function(a){0==a.code&&(console.log(a.data),e.setState({data:a.data,loading:!1}))}})}},{key:"render",value:function(){var e=this,a=this,t=this.state,l=t.loading,n=(t.data,t.columns),r=(t.spdxVisible,t.drawerData,this.props.form),o=r.getFieldDecorator,i=(r.getFieldValue,this.props.modelData),s=i.props,c={labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}},d=o("Stringkey")(Q.a.createElement(ne["a"],{style:{width:"100px"}},Q.a.createElement(Option,{value:"#in"},"\u5305\u542b"),Q.a.createElement(Option,{value:"#nin"},"\u53cd\u5411\u5305\u542b"))),u=o("amount1key")(Q.a.createElement(ne["a"],{style:{width:"100px"}},Q.a.createElement(Option,{key:"#lt",value:"#lt"},"\u5c0f\u4e8e"),Q.a.createElement(Option,{value:"#lte"},"\u5c0f\u4e8e\u7b49\u4e8e"),Q.a.createElement(Option,{value:"#gt"},"\u5927\u4e8e"),Q.a.createElement(Option,{value:"#gte"},"\u5927\u4e8e\u7b49\u4e8e"),Q.a.createElement(Option,{value:"#eq"},"\u7b49\u4e8e"),Q.a.createElement(Option,{value:"#ne"},"\u4e0d\u7b49\u4e8e"))),p=o("amount2key")(Q.a.createElement(ne["a"],{style:{width:"100px"}},Q.a.createElement(Option,{value:"#lt"},"\u5c0f\u4e8e"),Q.a.createElement(Option,{value:"#lte"},"\u5c0f\u4e8e\u7b49\u4e8e"),Q.a.createElement(Option,{value:"#gt"},"\u5927\u4e8e"),Q.a.createElement(Option,{value:"#gte"},"\u5927\u4e8e\u7b49\u4e8e"),Q.a.createElement(Option,{value:"#eq"},"\u7b49\u4e8e"),Q.a.createElement(Option,{value:"#ne"},"\u4e0d\u7b49\u4e8e"))),m=s.map(function(e,a){return Q.a.createElement("div",{key:a},Q.a.createElement(le["a"],{span:24},Q.a.createElement(re["a"],{span:5},Q.a.createElement(W["a"].Item,I()({},c,{label:"\u5bf9\u8c61\u5c5e\u6027"}),o("props[".concat(a,"]"),{initialValue:e.name})(Q.a.createElement(_["a"],{disabled:!0})))),Q.a.createElement(re["a"],{span:5},"1"==e.type?Q.a.createElement(W["a"].Item,I()({},c,{label:"\u6761\u4ef6\u8fd0\u7b97\u7b26"}),o("StringValue",{})(Q.a.createElement(_["a"],{addonBefore:d,style:{width:"500px"}}))):"2"==e.type?Q.a.createElement(Q.a.Fragment,null,Q.a.createElement(W["a"].Item,I()({},c,{label:"\u6761\u4ef6\u8fd0\u7b97\u7b26"}),o("amount1Value",{})(Q.a.createElement(_["a"],{addonBefore:u}))),Q.a.createElement(W["a"].Item,I()({},c,{label:"         ",style:{marginTop:"-30px"}}),o("amount2Value",{})(Q.a.createElement(_["a"],{addonBefore:p})))):"0"==e.type?Q.a.createElement("div",null,"kgjdfgg"):null),Q.a.createElement(re["a"],{span:5},Q.a.createElement(W["a"].Item,I()({},c,{label:"\u5bf9\u8c61\u7c7b\u578b",style:{display:"none"}}),o("type[".concat(a,"]"),{initialValue:e.type})(Q.a.createElement(_["a"],{disabled:!0}))))))});return Q.a.createElement("div",null,Q.a.createElement(C["a"],{title:"\u589e\u52a0\u5ba1\u6279\u89c4\u5219",width:"81.5%",onClose:this.drawerClose,visible:this.state.sxdyVisible},Q.a.createElement(le["a"],{span:24},Q.a.createElement(re["a"],{span:5},Q.a.createElement(W["a"].Item,I()({},c,{label:"\u89c4\u5219\u540d\u79f0"}),o("name",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u89c4\u5219\u540d\u79f0!"}]})(Q.a.createElement(_["a"],{placeholder:"",style:{width:"80%"}})))),Q.a.createElement(re["a"],{span:5},Q.a.createElement(W["a"].Item,I()({},c,{label:"\u89c4\u5219\u8bf4\u660e"}),o("desc",{})(Q.a.createElement(_["a"],{placeholder:"",style:{width:"80%"}}))))),Q.a.createElement(le["a"],null,Q.a.createElement(re["a"],{span:5},Q.a.createElement(W["a"].Item,I()({},c,{label:"\u5ba1\u6279\u7528\u6237"}),o("user")(Q.a.createElement(ne["a"],{mode:"tags",allowClear:!0,showSearch:!0,placeholder:"\u8bf7\u9009\u62e9\u5ba1\u6279\u7528\u6237",style:{width:"80%"}},this.state.userlist?this.state.userlist.map(function(e){return Q.a.createElement(ne["a"].Option,{key:e.account,value:e.account},e.account)}):null)))),Q.a.createElement(re["a"],{span:5},Q.a.createElement(W["a"].Item,I()({},c,{label:"\u5ba1\u6279\u89d2\u8272"}),o("role",{initialValue:""})(Q.a.createElement(ne["a"],{allowClear:!0,showSearch:!0,placeholder:"\u8bf7\u9009\u62e9\u5ba1\u6279\u89d2\u8272",style:{width:"80%"}},this.state.Rolelist?this.state.Rolelist.map(function(e){return Q.a.createElement(ne["a"].Option,{key:e.name,value:e.name},e.name)}):null))))),Q.a.createElement(le["a"],null,Q.a.createElement(re["a"],{span:5},Q.a.createElement(W["a"].Item,I()({},c,{label:"\u5173\u7cfb\u8fd0\u7b97\u7b26"}),o("gxysf",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u5173\u7cfb\u8fd0\u7b97\u7b26!"}]})(Q.a.createElement(ne["a"],{allowClear:!0,showSearch:!0,style:{width:"80%"}},Q.a.createElement(ne["a"].Option,{key:"#and",value:"#and"},"\u5e76\u4e14"),Q.a.createElement(ne["a"].Option,{key:"#or",value:"#or"},"\u6216\u8005"),Q.a.createElement(ne["a"].Option,{key:"#not",value:"#not"},"\u975e")))))),m,Q.a.createElement(W["a"].Item,null,Q.a.createElement(P["a"],{type:"primary",onClick:this.sxSubmit},"\u786e\u8ba4"))),Q.a.createElement(C["a"],{title:"\u589e\u52a0\u5b50\u5ba1\u6279\u89c4\u5219",width:"81.5%",onClose:this.AdddrawerClose,visible:this.state.AddsxdyVisible},Q.a.createElement(me,{modelData:i,Addrecord:this.state.Addrecord,query:a.query.bind(this),AdddrawerClose:this.AdddrawerClose})),Q.a.createElement(L["a"],{title:"\u4fee\u6539\u5ba1\u6279\u89c4\u5219",width:"65.5%",visible:this.state.EditsxdyVisible,onCancel:this.EditdrawerClose,destroyOnClose:!0,footer:null},Q.a.createElement(ye,{modelData:i,query:a.query.bind(this),Editrecord:this.state.Editrecord,EditdrawerClose:this.EditdrawerClose})),Q.a.createElement(P["a"],{type:"primary",style:{marginBottom:"12px"},onClick:function(a){a&&a.preventDefault(),oe["a"].checkAuthAndExecute(e.props.dispatch,Ee,function(){return e.ShowDrawer()},[],e.handleHideLoading)}},"\u65b0\u589e\u5ba1\u6279\u89c4\u5219"),Q.a.createElement(q["a"],{columns:n,dataSource:this.state.data,loading:l,rowKey:function(e){return e._id}}))}}]),a}(Y["Component"]),f=v))||f)||f),ke=(W["a"].Item,g=Object($["connect"])(function(e){var a=e.approval,t=e.loading;return{approval:a,loading:t.models.approval}}),w=W["a"].create(),g(k=w((b=function(e){function a(){var e,t;z()(this,a);for(var l=arguments.length,n=new Array(l),r=0;r<l;r++)n[r]=arguments[r];return t=G()(this,(e=Z()(a)).call.apply(e,[this].concat(n))),t.state={Actioncolumns:[{title:"\u5ba1\u6279\u4ebaID",dataIndex:"user",width:"20%"},{title:"\u5ba1\u6279\u4eba\u89d2\u8272",dataIndex:"roles",width:"20%"},{title:"\u5ba1\u6279\u65f6\u95f4",dataIndex:"time",width:"20%",render:function(e,a){return oe["a"].isNull(String(e))?null:oe["a"].fmtMomentDate(e)}},{title:"\u5ba1\u6279\u52a8\u4f5c",dataIndex:"action",width:"20%",render:function(e,a){var t="";return 0===e?t="\u8f6c\u79fb":1===e?t="\u901a\u8fc7":-1===e?t="\u4e0d\u901a\u8fc7":-2===e&&(t="\u64a4\u9500"),t}},{title:"\u5ba1\u6279\u610f\u89c1",dataIndex:"opinion",width:"20%"}],columns:[{title:"\u5bf9\u8c61\u7c7b\u578bID",dataIndex:"target",width:"20%"},{title:"\u5ba1\u6279\u89c4\u5219",dataIndex:"comment",width:"20%"},{title:"\u89c4\u5219\u8bf4\u660e",dataIndex:"opinion",width:"15%"},{title:"\u53d1\u8d77\u4ebaID",dataIndex:"user",width:"15%"},{title:"\u5ba1\u6279\u72b6\u6001",dataIndex:"status",width:"15%",render:function(e,a){var t="";return 0===e?t="\u8fd8\u672a\u7ed3\u675f":1===e?t="\u901a\u8fc7":-1===e?t="\u4e0d\u901a\u8fc7":-2===e&&(t="\u64a4\u9500"),t}},{title:"\u64cd\u4f5c",align:"center",key:"action",width:"15%",render:function(e){return Q.a.createElement("span",null,Q.a.createElement("a",{onClick:function(){return t.ShowDrawer(e)}},"\u5ba1\u6279\u52a8\u4f5c"))}}],data:[],Actiondata:[],sxdyVisible:!1},t.ShowDrawer=function(e){var a=t.props.dispatch;console.log("===data===",e),a({type:"approval/listAction",payload:{skip:0,limit:0,process:e._id},callback:function(e){if(200==e.code){console.log(e.datas);var a=e.datas;t.setState({Actiondata:a[1],loading:!1})}}}),t.setState({sxdyVisible:!0})},t.drawerClose=function(){t.setState({sxdyVisible:!1})},t}return X()(a,e),U()(a,[{key:"componentDidMount",value:function(){this.query()}},{key:"query",value:function(){var e=this,a=this.props,t=a.modelData,l=a.dispatch;console.log("====modelData===",t._id);var n=["target",1];l({type:"approval/listProcess",payload:{target:t._id,user:null,actor:null,toUser:null,toRoles:null,status:null,sortby:n,skip:0,limit:0},callback:function(a){if(0==a.code){console.log(a.data);var t=a.data;e.setState({data:t[1],loading:!1})}}})}},{key:"render",value:function(){var e=this.state,a=e.loading,t=(e.data,e.columns),l=(e.spdxVisible,e.Actioncolumns),n=(e.Actiondata,this.props.form);n.getFieldDecorator,n.getFieldValue;return Q.a.createElement("div",null,Q.a.createElement(C["a"],{title:"\u5ba1\u6279\u52a8\u4f5c",width:"81.5%",onClose:this.drawerClose,visible:this.state.sxdyVisible,destroyOnClose:!0},Q.a.createElement(q["a"],{columns:l,dataSource:this.state.Actiondata,loading:a})),Q.a.createElement(q["a"],{columns:t,dataSource:this.state.data,loading:a,rowKey:function(e){return e._id}}))}}]),a}(Y["Component"]),k=b))||k)||k);t.d(a,"default",function(){return Oe});var be=W["a"].Item,Se=he["a"].SPGL_ADDSPDX.key,xe=he["a"].SPGL_DETAIL.key,De=he["a"].SPGL_DELETE.key,Ve=he["a"].SPGL_SPDXSX.key,Ce=he["a"].SPGL_SPGZ.key,Oe=(S=Object($["connect"])(function(e){var a=e.approval,t=e.loading;return{approval:a,loading:t.models.approval}}),x=W["a"].create(),S(D=x((V=function(e){function a(){var e,t;z()(this,a);for(var l=arguments.length,n=new Array(l),r=0;r<l;r++)n[r]=arguments[r];return t=G()(this,(e=Z()(a)).call.apply(e,[this].concat(n))),t.state={loading:!0,data:[],columns:[{title:"\u5bf9\u8c61\u7c7b\u578bID",dataIndex:"_id",width:"20%"},{title:"\u5bf9\u8c61\u7c7b\u578b\u540d\u5b57",dataIndex:"name",width:"20%"},{title:"\u5bf9\u8c61\u7c7b\u578b\u8bf4\u660e",dataIndex:"desc",width:"20%"},{title:"\u64cd\u4f5c",align:"center",key:"action",width:"20%",render:function(e){return Q.a.createElement("span",null,Q.a.createElement("a",{onClick:function(a){a&&a.preventDefault(),oe["a"].checkAuthAndExecute(t.props.dispatch,xe,function(){return t.spdxtk("02","\u5ba1\u6279\u5bf9\u8c61\u8be6\u60c5",e)},[e],t.handleShowLoading,t.handleHideLoading)}},"\u8be6\u60c5"),Q.a.createElement(N["a"],{type:"vertical"}),Q.a.createElement("a",{onClick:function(a){a&&a.preventDefault(),oe["a"].checkAuthAndExecute(t.props.dispatch,De,function(){return t.del(e)},[])}},"\u5220\u9664"),Q.a.createElement(N["a"],{type:"vertical"}),Q.a.createElement(F["a"],{overlay:t.CzMenu(e)},Q.a.createElement(P["a"],{size:"small"},"\u66f4\u591a ",Q.a.createElement(B["a"],{type:"down"}))))}}],spdxVisible:!1,modelType:"",modelName:"",modelData:"",sxdyVisible:!1,drawerType:"",drawerName:"",drawerData:[]},t.CzMenu=function(e){return Q.a.createElement(R["a"],null,Q.a.createElement(R["a"].Item,{onClick:function(a){oe["a"].checkAuthAndExecute(t.props.dispatch,Ve,function(){return t.sxdyct("01","\u5ba1\u6279\u5bf9\u8c61\u5c5e\u6027",e)},[])}},"\u5ba1\u6279\u5bf9\u8c61\u5c5e\u6027"),Q.a.createElement(R["a"].Item,{onClick:function(a){oe["a"].checkAuthAndExecute(t.props.dispatch,Ce,function(){return t.sxdyct("02","\u5ba1\u6279\u89c4\u5219",e)},[])}},"\u5ba1\u6279\u89c4\u5219"))},t.onRef=function(e){t.child=e},t.del=function(e){var a=t.props.dispatch;console.log("===daa=t===",e),L["a"].confirm({title:"\u786e\u8ba4\u5220\u9664 '".concat(e.name?e.name:"\u8be5\u680f\u76ee","' \u5417?"),content:"",okText:"\u662f",okType:"danger",cancelText:"\u5426",onOk:function(){a({type:"approval/delTarget",payload:{id:e._id},callback:function(e){0==e.code?(T["a"].success("\u5220\u9664\u6210\u529f"),t.query(),t.forceUpdate()):T["a"].error(e.message)}})},onCancel:function(){}})},t.handleSubmit=function(){var e=t.props,a=e.form,l=e.dispatch,n=t.state,r=n.data,o=n.modelType,i=a.getFieldValue("spid"),s=a.getFieldValue("spmz"),c=a.getFieldValue("spsm"),d=0,u="01"==o?"\u65b0\u589e\u5ba1\u6279\u5bf9\u8c61\u6210\u529f":"\u4fee\u6539\u5ba1\u6279\u5bf9\u8c61\u6210\u529f",p="01"==o?"\u65b0\u589e\u5ba1\u6279\u5bf9\u8c61\u5931\u8d25":"\u4fee\u6539\u5ba1\u6279\u5bf9\u8c61\u5931\u8d25";if(""==i)return t.setState({spdxVisible:!0}),T["a"].warning("\u5bf9\u8c61\u7c7b\u578bID\u4e0d\u80fd\u4e3a\u7a7a");if("01"==o){var m=[];if(r.forEach(function(e){m.push(e._id)}),m.includes(i))return t.setState({spdxVisible:!0}),T["a"].warning("\u5bf9\u8c61\u7c7b\u578bID\u4e0d\u80fd\u91cd\u590d")}l({type:"approval/setTarget",payload:{id:i,name:s,desc:c,props:null,timeout:d,event:null},callback:function(e){0==e.code?(t.query(),T["a"].success(u),t.forceUpdate()):T["a"].error("".concat(p,",\u539f\u56e0\u4e3a\uff1a").concat(e.message))}})},t.spdxtk=function(e,a,l){console.log(l),t.setState({spdxVisible:!0,modelType:e,modelName:a,modelData:l||""})},t.spdxOk=function(){t.setState({spdxVisible:!1}),t.handleSubmit()},t.spdxCancel=function(){t.setState({spdxVisible:!1,modelType:"",modelName:"",modelData:""})},t.search=function(){var e=t.props,a=e.form,l=e.dispatch,n=a.getFieldValue("cxid")?a.getFieldValue("cxid"):null,r=a.getFieldValue("cxmz")?a.getFieldValue("cxmz"):null;if(null==n&&null==r)return t.query(),void T["a"].success("\u67e5\u8be2\u6210\u529f");var o=[];o=["_id",1],l({type:"approval/query",payload:{skip:0,limit:0,id:n,name:r,sortby:o},callback:function(e){0==e.code&&(T["a"].success("\u67e5\u8be2\u6210\u529f"),t.setState({data:e.data[1],loading:!1}))}})},t.handleShowLoading=function(){t.setState({loading:!0})},t.handleHideLoading=function(){t.setState({loading:!1})},t.sxdyct=function(e,a,l){console.log(e),console.log("===data==",l.props),"02"!=e||void 0!=l.props?t.setState({sxdyVisible:!0,drawerType:e,drawerName:a,drawerData:l.props?l.props:[],modelData:l}):oe["a"].error(null,"\u9519\u8bef",Q.a.createElement("div",null,Q.a.createElement("span",null,"\u8bf7\u5148\u521b\u5efa\u5ba1\u6279\u5bf9\u8c61\u5c5e\u6027\uff01")),function(){})},t.drawerClose=function(){t.setState({sxdyVisible:!1,drawerType:"",drawerName:"",drawerData:[]})},t}return X()(a,e),U()(a,[{key:"componentDidMount",value:function(){this.query()}},{key:"componentWillUnmount",value:function(){console.log("\u7ec4\u4ef6\u9500\u6bc1")}},{key:"query",value:function(){var e=this,a=[];a=["_id",1];var t=this;t.props.dispatch({type:"approval/query",payload:{id:null,name:null,sortby:a,skip:0,limit:0},callback:function(a){0==a.code&&e.setState({data:a.data[1],loading:!1})}})}},{key:"render",value:function(){var e=this,a=this,t=this.state,l=t.loading,n=t.data,r=t.columns,o=t.spdxVisible,i=t.modelName,s=t.modelData,c=t.sxdyVisible,d=t.drawerType,u=t.drawerName,p=t.drawerData,m=this.props.form.getFieldDecorator,y={labelCol:{span:5},wrapperCol:{span:15}};return console.log("=====dfdfdf==",this.state.spdxVisible),Q.a.createElement(te["a"],{title:!1},Q.a.createElement(A["a"],{style:{margin:-24}},Q.a.createElement("div",{className:ae.a.header},Q.a.createElement(W["a"],{layout:"inline"},Q.a.createElement("div",{className:ae.a.search},Q.a.createElement("div",null,Q.a.createElement("div",{className:ae.a.cols},Q.a.createElement(be,{label:Q.a.createElement("span",{style:{width:"100px",display:"inline-block"}},"\u5bf9\u8c61\u7c7b\u578b\u540d\u5b57")},m("cxmz")(Q.a.createElement(_["a"],{placeholder:"\u8bf7\u8f93\u5165\u5bf9\u8c61\u7c7b\u578b\u540d\u5b57",style:{width:270}}))),Q.a.createElement(be,{label:Q.a.createElement("span",{style:{width:"100px",display:"inline-block"}},"\u5bf9\u8c61\u7c7b\u578bID")},m("cxid")(Q.a.createElement(_["a"],{placeholder:"\u8bf7\u8f93\u5165\u5bf9\u8c61\u7c7b\u578bID",style:{width:270}}))),Q.a.createElement("span",{className:ae.a.submitButtons},Q.a.createElement(P["a"],{type:"primary",onClick:this.search},"\u67e5\u8be2"),Q.a.createElement(P["a"],{style:{marginLeft:8},onClick:function(){var a=e.props.form;a.resetFields(),e.query(),T["a"].success("\u91cd\u7f6e\u6210\u529f")}},"\u91cd\u7f6e"))))))),Q.a.createElement(P["a"],{style:{marginBottom:8},type:"primary",onClick:function(a){a&&a.preventDefault(),oe["a"].checkAuthAndExecute(e.props.dispatch,Se,function(){return e.spdxtk("01","\u65b0\u589e\u5ba1\u6279\u5bf9\u8c61")},[],e.handleShowLoading,e.handleHideLoading)}},"\u65b0\u589e\u5ba1\u6279\u5bf9\u8c61"),Q.a.createElement(q["a"],{className:ae.a.table,columns:r,dataSource:n,loading:l,rowKey:function(e){return e._id}})),this.state.spdxVisible?Q.a.createElement(L["a"],{title:i,visible:o,onOk:this.spdxOk,onCancel:this.spdxCancel,destroyOnClose:!0},Q.a.createElement(W["a"],I()({},y,{labelAlign:"left",onSubmit:this.handleSubmit}),Q.a.createElement(be,{label:"\u5bf9\u8c61\u7c7b\u578bID"},m("spid",{initialValue:""==s?"":s._id})(Q.a.createElement(_["a"],{placeholder:"\u8bf7\u8f93\u5165\u5bf9\u8c61\u7c7b\u578bID",style:{width:300}}))),Q.a.createElement(be,{label:"\u5bf9\u8c61\u7c7b\u578b\u540d\u5b57"},m("spmz",{initialValue:""==s?"":s.name})(Q.a.createElement(_["a"],{placeholder:"\u8bf7\u8f93\u5165\u5bf9\u8c61\u7c7b\u578b\u540d\u5b57",style:{width:300}}))),Q.a.createElement(be,{label:"\u5bf9\u8c61\u7c7b\u578b\u8bf4\u660e"},m("spsm",{initialValue:""==s?"":s.desc})(Q.a.createElement(_["a"],{placeholder:"\u8bf7\u8f93\u5165\u5bf9\u8c61\u7c7b\u578b\u8bf4\u660e",style:{width:300}}))))):null,Q.a.createElement(C["a"],{title:u,width:"81.5%",onClose:this.drawerClose,visible:c,destroyOnClose:!0},"01"==d?Q.a.createElement(ie,{drawerData:p,modelData:s,drawerClose:this.drawerClose,query:a.query.bind(this)}):"02"==d?Q.a.createElement(we,{modelData:s}):Q.a.createElement(ke,{modelData:s})))}}]),a}(Y["Component"]),D=V))||D)||D)}}]);