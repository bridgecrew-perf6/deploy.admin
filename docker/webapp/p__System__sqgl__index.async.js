(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[86],{CriG:function(e,t,a){"use strict";a.r(t);a("g9YV");var s=a("wCAj"),n=(a("y8nQ"),a("Vl3Y")),l=(a("5NDa"),a("5rEg")),o=(a("Pwec"),a("CtXQ")),c=(a("+L6B"),a("2/Rp")),r=(a("P2fV"),a("NJEC")),i=a("jehZ"),d=a.n(i),u=(a("miYZ"),a("tsqr")),m=a("2Taf"),h=a.n(m),p=a("vZ4D"),y=a.n(p),g=a("l4Ni"),f=a.n(g),b=a("ujKo"),k=a.n(b),S=a("MhPg"),v=a.n(S),E=(a("ozfa"),a("MJZm")),j=(a("B9cy"),a("Ol7k")),T=a("q1tI"),C=a.n(T),M=a("MuoO"),N=a("WT6/"),x=a.n(N),q=a("zcrV"),w=j["a"].Content,I=j["a"].Sider,D=E["a"].TreeNode,V=function(e){function t(){var e,a;h()(this,t);for(var s=arguments.length,n=new Array(s),l=0;l<s;l++)n[l]=arguments[l];return a=f()(this,(e=k()(t)).call.apply(e,[this].concat(n))),a.state={treeStatus:!1,tableStatus:!1,yhglVisible:!1,loadStatus:!0,treeID:[],jsStyle:[],treeChecked:[],jsArr:[],dataT:[],tree:[]},a.submit=function(){var e=a.props.dispatch;if(a.state.treeStatus&&(a.state.isSet?e({type:"sqglModel/set",payload:{actions:"2",value:"0",roles:a.state.jsStyle,aclId:a.state.treeChecked.join(",")},callback:function(t){200===t.code?(console.log(t),e({type:"sqglModel/getMsg",payload:{domain:"system",roles:a.state.jsStyle},callback:function(e){200===e.code||u["a"].error("\u5931\u8d25\uff0c\u539f\u56e0\u4e3a\uff1a".concat(t.message))}}),u["a"].success(t.message)):u["a"].error("\u5931\u8d25\uff0c\u539f\u56e0\u4e3a\uff1a".concat(t.message))}}):e({type:"sqglModel/submit",payload:{actions:"2",domain:"system",targetType:"menu",value:"0",roles:a.state.jsStyle,targetId:a.state.treeChecked.join(",")},callback:function(t){200===t.code?(console.log(t),u["a"].success(t.message),e({type:"sqglModel/getMsg",payload:{domain:"system",roles:a.state.jsStyle},callback:function(e){if(200===e.code){var s=e.datas.length>0;a.setState({treeChecked:e.datas,isSet:s})}else u["a"].error("\u5931\u8d25\uff0c\u539f\u56e0\u4e3a\uff1a".concat(t.message))}})):u["a"].error("\u5931\u8d25\uff0c\u539f\u56e0\u4e3a\uff1a".concat(t.message))}})),a.state.tableStatus){console.log(a.state.treeID),console.log(a.state.jsArr),a.setState({loadStatus:!0});var t=[];a.state.jsArr.map(function(e){t.push("R.".concat(e))}),a.state.isSet?e({type:"sqglModel/set",payload:{actions:"2",value:"0",roles:t.join(","),aclId:a.state.treeID.join(",")},callback:function(e){200===e.code?(console.log(e),u["a"].success(e.message),a.setState({loadStatus:!1})):u["a"].error("\u5931\u8d25\uff0c\u539f\u56e0\u4e3a\uff1a".concat(e.message))}}):e({type:"sqglModel/submit",payload:{actions:"2",domain:"system",targetType:"menu",value:"0",roles:t.join(","),targetId:a.state.treeID.join(",")},callback:function(e){200===e.code?(console.log(e),a.setState({loadStatus:!1}),u["a"].success(e.message)):u["a"].error("\u5931\u8d25\uff0c\u539f\u56e0\u4e3a\uff1a".concat(e.message))}})}},a.onSelect=function(e,t){t.selected&&a.setState({treeStatus:!1,tableStatus:!0,jsStyle:null,treeID:e,tableThree:!1,loadStatus:!0});var s=a.props.dispatch;s({type:"sqglModel/getMsg",payload:{domain:"system",targetIds:t.selected?e.join(","):a.state.treeID.join(",")},callback:function(e){if(200===e.code){var t=e.datas.length>0;a.setState({jsArr:e.datas,isSet:t,loadStatus:!1})}else u["a"].error("\u5931\u8d25\uff0c\u539f\u56e0\u4e3a\uff1a".concat(e.message))}})},a.onCheck=function(e,t){a.setState({treeChecked:e})},a.getJs=function(e){console.log("====e=====",e),a.setState({jsStyle:e.node,treeStatus:!0,tableStatus:!1,tableThree:!0,tableThreeName:e.name,tableThreeNode:e.node});var t=a.props.dispatch;t({type:"sqglModel/listUserByNode",payload:{node:e.node},callback:function(t){if(200===t.code){var s=[];t.datas[1].map(function(e){s.push({key:e._id,account:e.account,name:e.name})}),a.setState({dataT:s})}else u["a"].error("\u5931\u8d25\uff0c\u539f\u56e0\u4e3a\uff1a".concat(e.message))}}),t({type:"sqglModel/getMsg",payload:{domain:"system",roles:e.node},callback:function(e){if(200===e.code){var t=e.datas.length>0;a.setState({treeChecked:e.datas,isSet:t})}else u["a"].error("\u5931\u8d25\uff0c\u539f\u56e0\u4e3a\uff1a".concat(e.message))}})},a.renderTreeNodes=function(e){return e.map(function(e){return e.children?C.a.createElement(D,{title:e.title,key:e.key,dataRef:e},a.renderTreeNodes(e.children)):C.a.createElement(D,d()({key:e.key},e))})},a}return v()(t,e),y()(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.dispatch;t({type:"sqglModel/index",payload:{fileName:"rewin.ubsi.menu"},callback:function(t){var a=t.datas.menu;console.log("===tr===",a),e.setState({tree:a})}}),t({type:"sqglModel/getRoleTree",callback:function(){e.setState({loadStatus:!1})}})}},{key:"cxjs",value:function(){var e=this.props,t=e.form,a=e.dispatch,s=t.getFieldValue("jsName")?t.getFieldValue("jsName"):null;a({type:"sqglModel/dem",payload:{depth:"0",domain:"system",name:s}})}},{key:"cxjsReset",value:function(){var e=this,t=this.props,a=t.form,s=t.dispatch;a.resetFields(),s({type:"sqglModel/getRoleTree",callback:function(){e.setState({loadStatus:!1})}})}},{key:"cxyh",value:function(){var e=this,t=this.props,a=t.form,s=t.dispatch,n=a.getFieldValue("yhName")?a.getFieldValue("yhName"):null;s({type:"sqglModel/listUser",payload:{limit:0,skip:0,account:n},callback:function(t){if(200===t.code){var a=[];t.datas.map(function(e){a.push({key:e._id,account:e.account,name:e.name})}),e.setState({dataT:a})}else u["a"].error("\u5931\u8d25\uff0c\u539f\u56e0\u4e3a\uff1a".concat(t.message))}})}},{key:"cxyhReset",value:function(){var e=this,t=this.props,a=t.form,s=t.dispatch;a.resetFields(),s({type:"sqglModel/listUserByNode",payload:{node:this.state.tableThreeNode},callback:function(t){if(200===t.code){var a=[];t.datas[1].map(function(e){a.push({key:e._id,account:e.account,name:e.name})}),e.setState({dataT:a})}else u["a"].error("\u5931\u8d25\uff0c\u539f\u56e0\u4e3a\uff1a".concat(t.message))}})}},{key:"confirm",value:function(e){var t=this,a=this.state.dataT.filter(function(t){return t!==e}),s=this.props.dispatch,n=[];a.map(function(e){n.push(e.key)}),s({type:"sqglModel/addUser",payload:{roleID:this.state.tableThreeNode,userID:n?n.join(","):null},callback:function(e){200===e.code?(u["a"].success("\u5220\u9664\u7528\u6237\u6210\u529f"),s({type:"sqglModel/listUserByNode",payload:{node:t.state.tableThreeNode},callback:function(a){if(200===e.code){var s=[];a.datas[1].map(function(e){s.push({key:e._id,account:e.account,name:e.name})}),t.setState({dataT:s})}else u["a"].error("\u5931\u8d25\uff0c\u539f\u56e0\u4e3a\uff1a".concat(e.message))}})):u["a"].error("\u5220\u9664\u7528\u6237\u5931\u8d25,\u539f\u56e0\u4e3a\uff1a".concat(e.message))}})}},{key:"showYh",value:function(){this.setState({yhglVisible:!0})}},{key:"getYhglMsg",value:function(e){var t=this,a=this.props.dispatch;this.setState({yhglVisible:!1});var s=[];e.map(function(e){s.push(e.id)}),console.log("------44444-----",this.state.jsStyle),a({type:"sqglModel/addUser",payload:{roleID:this.state.jsStyle,userID:s?s.join(","):null},callback:function(e){200===e.code?(u["a"].success("\u6dfb\u52a0/\u4fee\u6539\u7528\u6237\u6210\u529f"),a({type:"sqglModel/listUserByNode",payload:{node:t.state.jsStyle},callback:function(a){if(200===e.code){var s=[];a.datas[1].map(function(e){s.push({key:e._id,account:e.account,name:e.name})}),t.setState({dataT:s})}else u["a"].error("\u5931\u8d25\uff0c\u539f\u56e0\u4e3a\uff1a".concat(e.message))}})):u["a"].error("\u6dfb\u52a0/\u4fee\u6539\u7528\u6237\u5931\u8d25,\u539f\u56e0\u4e3a\uff1a".concat(e.message))}})}},{key:"close",value:function(){this.setState({yhglVisible:!1})}},{key:"showYhTable",value:function(e){var t=this;console.log("showYhTable===========",e);var a=this.props.dispatch;this.setState({tableThree:!0,tableThreeName:e.name,tableThreeNode:e.node,jsStyle:e.node}),a({type:"sqglModel/listUserByNode",payload:{node:e.node},callback:function(e){if(200===e.code){var a=[];e.datas[1].map(function(e){a.push({key:e._id,account:e.account,name:e.name})}),t.setState({dataT:a})}else u["a"].error("\u5931\u8d25\uff0c\u539f\u56e0\u4e3a\uff1a".concat(e.message))}})}},{key:"closeYhTable",value:function(){this.setState({tableThree:!1})}},{key:"render",value:function(){var e=this,t=this.props,a=t.form,i=t.jsList,d=this.state,u=d.tableStatus,m=d.treeStatus,h=d.treeChecked,p=d.jsStyle,y=d.jsArr,g=d.tableThree,f=d.dataT,b=d.tree,k=d.tableThreeName,S=a.getFieldDecorator,v=[{title:"\u89d2\u8272",render:function(t){return C.a.createElement("a",{style:p===t.node?{color:"#fa541c"}:{color:"rgba(0,0,0,.65)"},onClick:e.getJs.bind(e,t)},t.name)}},{title:"\u64cd\u4f5c",key:"action",render:function(t){return C.a.createElement("a",{href:"javaSrcipt:;",onClick:e.showYhTable.bind(e,t)},"\u67e5\u770b\u7528\u6237")}}],T=[{title:"\u7528\u6237\u540d",align:"center",render:function(e){return C.a.createElement("span",null,e.account)}},{title:"\u59d3\u540d",align:"center",render:function(e){return C.a.createElement("span",null,e.name)}},{title:"\u64cd\u4f5c",align:"center",key:"action",render:function(t){return C.a.createElement("span",null,C.a.createElement(r["a"],{title:"\u786e\u5b9a\u8981\u5220\u9664\u6b64\u7528\u6237?",onConfirm:e.confirm.bind(e,t),okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88"},C.a.createElement("a",{href:"javaSrcipt:;"},"\u5220\u9664")))}}],M={selectedRowKeys:y,onChange:function(t,a){e.setState({jsArr:t})},getCheckboxProps:function(e){return{disabled:"Disabled User"===e.name,name:e.name}}};return console.log(b),C.a.createElement("div",null,C.a.createElement("div",{style:{width:"100%",background:"#fff",marginBottom:".3%",display:"flex",justifyContent:"flex-start"}},C.a.createElement(c["a"],{type:"primary",style:{margin:"5px",width:"20%"},onClick:this.submit.bind(this)},"\u63d0\u4ea4")),C.a.createElement("div",{className:x.a.content},C.a.createElement(j["a"],null,C.a.createElement(I,{width:300,style:{background:"#fff"}},C.a.createElement(E["a"],{checkable:m,showLine:!0,switcherIcon:C.a.createElement(o["a"],{type:"down"}),onSelect:this.onSelect,onCheck:this.onCheck,checkedKeys:h||[]},this.renderTreeNodes(b))),C.a.createElement(j["a"],{style:{padding:"0 5px"}},C.a.createElement(w,{style:{background:"#fff",padding:24,margin:0,minHeight:280}},C.a.createElement("div",null,C.a.createElement("div",{style:{marginBottom:10}},C.a.createElement(n["a"],{style:{display:"flex",alignItems:"center"}},C.a.createElement(n["a"].Item,null,S("jsName")(C.a.createElement(l["a"],{placeholder:"\u8bf7\u8f93\u5165\u8981\u67e5\u8be2\u7684\u89d2\u8272\u540d",style:{width:170}}))),C.a.createElement("span",{className:x.a.submitButtons},C.a.createElement(c["a"],{type:"primary",style:{margin:"0 10px"},onClick:this.cxjs.bind(this)},C.a.createElement(o["a"],{type:"search"})),C.a.createElement(c["a"],{onClick:this.cxjsReset.bind(this)},C.a.createElement(o["a"],{type:"reload"}))))),C.a.createElement(s["a"],{rowSelection:u?M:null,columns:v,dataSource:i,size:"small",loading:this.state.loadStatus})))),g?C.a.createElement(j["a"],{style:{padding:"0"}},C.a.createElement(w,{style:{background:"#fff",padding:24,margin:0,minHeight:280}},C.a.createElement("div",null,C.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end"}},C.a.createElement(o["a"],{type:"close",onClick:this.closeYhTable.bind(this)})),C.a.createElement("div",{style:{marginBottom:10}},C.a.createElement(n["a"],{style:{display:"flex",alignItems:"center"}},C.a.createElement(n["a"].Item,null,S("yhName")(C.a.createElement(l["a"],{placeholder:"\u8bf7\u8f93\u5165\u8981\u67e5\u8be2\u7684\u7528\u6237\u540d",style:{width:170}}))),C.a.createElement("span",{className:x.a.submitButtons},C.a.createElement(c["a"],{type:"primary",style:{margin:"0 10px"},onClick:this.cxyh.bind(this)},C.a.createElement(o["a"],{type:"search"})),C.a.createElement(c["a"],{onClick:this.cxyhReset.bind(this)},C.a.createElement(o["a"],{type:"reload"})))),C.a.createElement("div",{style:{display:"flex",justifyContent:" space-between",alignItems:"center"}},C.a.createElement("div",null,C.a.createElement("sapn",null,"\u6240\u5c5e\u89d2\u8272\uff1a"),C.a.createElement("sapn",null,k)),C.a.createElement(c["a"],{style:{margin:"5px 0 2px"},onClick:this.showYh.bind(this)},"\u6dfb\u52a0/\u4fee\u6539\u7528\u6237"))),C.a.createElement(s["a"],{columns:T,dataSource:f,size:"small"})))):null)),C.a.createElement(q["a"],{yhglVisible:this.state.yhglVisible,handleSelectedYhgl:this.getYhglMsg.bind(this),handleYhglVisible:this.close.bind(this)}))}}]),t}(T["Component"]);t["default"]=Object(M["connect"])(function(e){return e.sqglModel})(n["a"].create()(V))},"WT6/":function(e,t,a){e.exports={content:"antd-pro-pages-system-sqgl-index-content",btn:"antd-pro-pages-system-sqgl-index-btn",checkList:"antd-pro-pages-system-sqgl-index-checkList"}}}]);