(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[100],{T6Na:function(e,t,a){"use strict";a.r(t);a("bbsP");var n=a("/wGt"),l=(a("+L6B"),a("2/Rp")),r=(a("g9YV"),a("wCAj")),c=(a("/zsF"),a("PArb")),i=(a("Q9mQ"),a("diRs")),s=(a("miYZ"),a("tsqr")),o=a("2Taf"),u=a.n(o),d=a("vZ4D"),p=a.n(d),m=a("l4Ni"),h=a.n(m),E=a("ujKo"),g=a.n(E),y=a("MhPg"),f=a.n(y),v=(a("2qtc"),a("kLXV")),b=(a("5NDa"),a("5rEg")),w=(a("OaEy"),a("2fM7")),x=(a("y8nQ"),a("Vl3Y")),k=a("q1tI"),T=a.n(k),S=a("suEo"),C=a.n(S),F=a("wd/R"),L=a.n(F),M=a("MuoO"),_=a("P4xi"),A=a("6Hmz"),D=A["a"].eventFlow_SWGL_Search.key,N=A["a"].eventFlow_SWGL_Stop.key,I=A["a"].eventFlow_SWGL_Fzsw.key,R=A["a"].eventFlow_SWGL_Retry.key,Y=A["a"].eventFlow_SWGL_Delete.key,q=x["a"].Item,V=w["a"].Option,O=(b["a"].TextArea,v["a"].confirm,function(e){function t(){var e,a;u()(this,t);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return a=h()(this,(e=g()(t)).call.apply(e,[this].concat(l))),a.state={TsList:[],Tableloading:!0,visible:!1,type:"",drawerTitle:"",acldata:null,jsglVisible:!1,roleType:null,role:[],roleName:[],edit_role:[],edit_roleName:[],cxRole:[],cxRoleName:[],alltags:null,BranchList:null,status:0,rolesList:[]},a.query=function(){a.props.dispatch({type:"swglModel/listTrans",payload:{name:null,group:null,status:null,sortby:["createTime",-1],skip:0,limit:0},callback:function(e){if("0"!=e.code)return s["a"].error("\u67e5\u8be2\u4e8b\u52a1\u5217\u8868\u9519\u8bef\uff1a".concat(e.data));var t=e.data[1];setTimeout(function(){a.setState({Tableloading:!1,TsList:t})},100)}})},a.retry=function(e){var t=a.props.dispatch;console.log("branch",e.id),t({type:"swglModel/retry",payload:{id:e._id},callback:function(e){"0"==e.code?(a.query(),s["a"].success("\u5206\u6b65\u4e8b\u52a1\u8865\u507f\u6210\u529f\uff01")):s["a"].error("\u5206\u6b65\u4e8b\u52a1\u8865\u507f\u5931\u8d25 \uff01".concat(e.data))}})},a.stop=function(e){var t=a.props.dispatch;console.log("transaction",e.id),t({type:"swglModel/stop",payload:{txid:e._id},callback:function(e){"0"==e.code?(a.query(),s["a"].success("\u4e8b\u52a1\u505c\u6b62\u6210\u529f\uff01")):s["a"].error("\u505c\u6b62\u4e8b\u52a1\u5931\u8d25 \uff01".concat(e.data))}})},a.del=function(e){var t=a.props.dispatch;console.log("transaction",e.id),v["a"].confirm({title:"\u786e\u8ba4\u5220\u9664 '".concat(e.name,"' \u5417?"),content:"",okText:"\u662f",okType:"danger",cancelText:"\u5426",onOk:function(){t({type:"swglModel/deleteTS",payload:{txid:e._id},callback:function(e){"0"==e.code?(a.query(),s["a"].success("\u4e8b\u52a1\u5220\u9664\u6210\u529f\uff01")):s["a"].error("\u5220\u9664\u4e8b\u52a1\u5931\u8d25 \uff01".concat(e.data))}})},onCancel:function(){}})},a.openDrawer=function(e,t,n){a.setState({visible:!0,type:e,drawerTitle:t,record:n}),a.setState({visible:!0,type:e,drawerTitle:t}),"03"==e&&(a.setState({drawerTitle:"\u5168\u5c40\u4e8b\u52a1\u540d\u79f0\uff1a ".concat(n.name)}),a.props.dispatch({type:"swglModel/listBranch",payload:{txid:n._id,initiator:null,status:null,sortby:["createTime",-1],skip:0,limit:0},callback:function(e){console.log(e),0==e.code?a.setState({BranchList:e.data[1]}):s["a"].error("\u5206\u6b65\u4e8b\u52a1\u67e5\u8be2\u51fa\u9519 ".concat(e.data))}}))},a.drawerClose=function(){a.setState({visible:!1,type:"",drawerTitle:"",acldata:null,scriptList:null})},a.showModal=function(e){a.setState({visible2:!0,shuju:JSON.stringify(e)})},a.handleCancel=function(e){a.setState({visible2:!1})},a.handleSearch=function(){var e=a.props,t=e.form,n=e.dispatch,l=(a.state.cxRole,t.getFieldValue("swname")?t.getFieldValue("swname"):null),r=t.getFieldValue("group")?t.getFieldValue("group"):null,c=t.getFieldValue("status")?t.getFieldValue("status"):null;console.log("\u67e5\u8be2\u53c2\u6570",l,c),n({type:"swglModel/listTrans",payload:{name:l,group:r,status:c,sortby:["createTime",-1],skip:0,limit:0},callback:function(e){"0"==e.code?(s["a"].success("\u67e5\u8be2\u6210\u529f\uff01"),a.setState({TsList:e.data[1]}),console.log(e)):s["a"].error("\u67e5\u8be2\u51fa\u9519 ".concat(e.data))}})},a.handel=function(e){var t=a.state.rolesList,n=!0,l=!1,r=void 0;try{for(var c,i=t[Symbol.iterator]();!(n=(c=i.next()).done);n=!0){var s=c.value;if(s._id==e)return s.name}}catch(e){l=!0,r=e}finally{try{n||null==i.return||i.return()}finally{if(l)throw r}}return e},a}return f()(t,e),p()(t,[{key:"componentDidMount",value:function(){this.query()}},{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator,a=this.state,o=(a.acldata,a.alltags),u=(a.roleType,a.TsList),d=(a.rolesList,a.edit_roleName,a.roleName,a.cxRoleName,a.edit_role,a.role,a.cxRole,o&&o.map(function(e){return T.a.createElement(V,{key:e},e)}),[{title:"\u4e8b\u52a1\u53d1\u8d77\u8005",align:"center",dataIndex:"initiator"},{title:"\u4e8b\u52a1\u9636\u6bb5",dataIndex:"stage",align:"center",render:function(e){return 0===e?T.a.createElement("span",null,"Try"):1===e?T.a.createElement("span",null,"Confirm"):-1===e?T.a.createElement("span",null,"Cancel"):-2===e?T.a.createElement("span",null,"\u8d85\u65f6"):-3===e?T.a.createElement("span",null,"\u7ec8\u6b62"):void 0}},{title:"\u4e8b\u52a1\u72b6\u6001",align:"center",render:function(e){return 0===e.status?T.a.createElement("span",null,"\u672a\u7ed3\u675f"):1===e.status?T.a.createElement("span",null,"\u6210\u529f"):-1===e.status?T.a.createElement(i["a"],{content:e.error},T.a.createElement("span",{style:{color:"red"}}," \u5931\u8d25")):void 0}},{title:"\u9636\u6bb5\u65f6\u95f4",dataIndex:"stageTime",align:"center",render:function(e){return T.a.createElement("span",null,e&&L()(e).format("YYYY-MM-DD"),T.a.createElement("br",null),e&&L()(e).format("HH:mm:ss"))}},{title:"Confirm/Cancel\u63d0\u4ea4\u70b9",dataIndex:"submit",align:"center",render:function(e){return 0===e?T.a.createElement("span",null,"\u4e0d\u63d0\u4ea4"):1===e?T.a.createElement("span",null,"\u53d1\u8d77\u8005"):2===e?T.a.createElement("span",null,"\u4efb\u610f\u5b9e\u4f8b"):void 0}},{title:"\u8865\u507f\u6b21\u6570",align:"center",dataIndex:"retry"},{title:"\u64cd\u4f5c",align:"center",width:"15%",render:function(t){return T.a.createElement(T.a.Fragment,null,T.a.createElement("a",{onClick:function(a){a&&a.preventDefault(),_["a"].checkAuthAndExecute(e.props.dispatch,R,e.showModal(t.data),[null])}},"\u6570\u636e"),T.a.createElement(c["a"],{type:"vertical"}),-1==t.status?T.a.createElement("a",{onClick:function(a){a&&a.preventDefault(),_["a"].checkAuthAndExecute(e.props.dispatch,R,e.retry(t),[null])}},"\u8865\u507f"):null)}}]),p=[{title:"\u4e8b\u52a1\u540d\u79f0",align:"center",render:function(t){return T.a.createElement("span",null,T.a.createElement("a",{style:{userSelect:"none"},onClick:function(a){a&&a.preventDefault(),_["a"].checkAuthAndExecute(e.props.dispatch,I,e.openDrawer("03","\u5206\u6b65\u4e8b\u52a1\u7ba1\u7406",t),[null])}},t.name))}},{title:"\u4e8b\u52a1\u5206\u7ec4",align:"center",dataIndex:"group"},{title:"\u4e8b\u52a1\u9636\u6bb5",dataIndex:"stage",align:"center",render:function(e){return 0===e?T.a.createElement("span",null,"Try"):1===e?T.a.createElement("span",null,"Confirm"):-1===e?T.a.createElement("span",null,"Cancel"):-2===e?T.a.createElement("span",null,"\u8d85\u65f6"):-3===e?T.a.createElement("span",null,"\u7ec8\u6b62"):void 0}},{title:"\u4e8b\u52a1\u72b6\u6001",dataIndex:"status",align:"center",render:function(e){return 0===e?T.a.createElement("span",null,"\u672a\u7ed3\u675f"):1===e?T.a.createElement("span",null,"\u6210\u529f"):-1===e?T.a.createElement("span",{style:{color:"red"}},"\u5931\u8d25"):void 0}},{title:"\u8d85\u65f6\u65f6\u95f4",dataIndex:"timeout",align:"center"},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"createTime",align:"center",render:function(e){return T.a.createElement("span",null,e&&L()(e).format("YYYY-MM-DD"),T.a.createElement("br",null),e&&L()(e).format("HH:mm:ss"))}},{title:"\u64cd\u4f5c",align:"center",width:"15%",render:function(t){return T.a.createElement(T.a.Fragment,null,0==t.status?T.a.createElement("div",null,T.a.createElement("a",{onClick:function(a){a&&a.preventDefault(),_["a"].checkAuthAndExecute(e.props.dispatch,N,e.stop(t),[null])}},"\u505c\u6b62"),T.a.createElement(c["a"],{type:"vertical"})):null,t.stage>=0&&1==t.status?T.a.createElement("a",{onClick:function(a){a&&a.preventDefault(),_["a"].checkAuthAndExecute(e.props.dispatch,Y,e.del(t),[null])}},"\u5220\u9664"):null)}}],m={pageSize:15},h=T.a.createElement("div",null,T.a.createElement("span",null,this.state.shuju)),E=T.a.createElement(T.a.Fragment,null,"03"==this.state.type?T.a.createElement(r["a"],{pagination:m,columns:d,dataSource:this.state.BranchList,size:"small"}):null);return T.a.createElement("div",null,T.a.createElement("div",{className:C.a.header},T.a.createElement(x["a"],{onSubmit:this.handleSearch,layout:"inline"},T.a.createElement("div",{className:C.a.search},T.a.createElement("div",null,T.a.createElement("div",{className:C.a.cols},T.a.createElement(q,{label:T.a.createElement("span",{style:{width:"60px",display:"inline-block"}},"\u4e8b\u52a1\u540d\u79f0")},t("swname")(T.a.createElement(b["a"],{placeholder:"\u8bf7\u8f93\u5165\u4e8b\u52a1\u540d\u79f0",style:{width:200}}))),T.a.createElement(q,{label:T.a.createElement("span",{style:{width:"60px",display:"inline-block"}},"\u4e8b\u52a1\u5206\u7ec4")},t("group")(T.a.createElement(b["a"],{placeholder:"\u8bf7\u8f93\u5165\u4e8b\u52a1\u5206\u7ec4",style:{width:200}}))),T.a.createElement(q,{label:T.a.createElement("span",{style:{width:"60px",display:"inline-block"}},"\u72b6\u6001")},t("status")(T.a.createElement(w["a"],{style:{width:100},placeholder:"\u8bf7\u9009\u62e9\u72b6\u6001\uff01",allowClear:!0},T.a.createElement(V,{value:null},"\u5168\u90e8"),T.a.createElement(V,{value:0},"\u672a\u7ed3\u675f"),T.a.createElement(V,{value:1},"\u5df2\u7ed3\u675f"),T.a.createElement(V,{value:-1},"\u975e\u6b63\u5e38\u7ed3\u675f")))))),T.a.createElement("span",{className:C.a.submitButtons},T.a.createElement(l["a"],{type:"primary",onClick:function(t){t&&t.preventDefault(),_["a"].checkAuthAndExecute(e.props.dispatch,D,e.handleSearch(),[null])}},"\u67e5\u8be2"),T.a.createElement(l["a"],{style:{marginLeft:8},onClick:function(){e.props.form.resetFields(),e.query(),e.setState({cxRole:[]}),s["a"].success("\u91cd\u7f6e\u6210\u529f")}},"\u91cd\u7f6e"))))),T.a.createElement("div",{className:C.a.content},T.a.createElement("div",null,T.a.createElement(r["a"],{pagination:m,columns:p,dataSource:u,loading:this.state.Tableloading,size:"small"}))),T.a.createElement(n["a"],{title:T.a.createElement(T.a.Fragment,null,this.state.drawerTitle),onClose:this.drawerClose,visible:this.state.visible,destroyOnClose:!0},E,"03"!=this.state.type?T.a.createElement("div",{style:{position:"absolute",right:0,bottom:0,width:"100%",borderTop:"1px solid #e9e9e9",padding:"10px 16px",background:"#fff",textAlign:"right"}},T.a.createElement(l["a"],{onClick:this.drawerClose,style:{marginRight:8}},"\u53d6\u6d88"),T.a.createElement(l["a"],{type:"primary",onClick:this.handleSubmit},"\u786e\u5b9a")):null),T.a.createElement(v["a"],{title:"\u6570\u636e",visible:this.state.visible2,onCancel:this.handleCancel,footer:null,destroyOnClose:!0}," ",h))}}]),t}(k["Component"]));t["default"]=Object(M["connect"])(function(e){return e.qxglModel})(x["a"].create()(O))},suEo:function(e,t,a){e.exports={header:"antd-pro-pages-transaction-index-header",search:"antd-pro-pages-transaction-index-search",cols:"antd-pro-pages-transaction-index-cols",content:"antd-pro-pages-transaction-index-content",btns:"antd-pro-pages-transaction-index-btns",modelMsg:"antd-pro-pages-transaction-index-modelMsg"}}}]);